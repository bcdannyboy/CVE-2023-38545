#!/bin/bash

# Check if ssh command is available
if ! command -v ssh &> /dev/null; then
    echo "ssh command not found. Please install ssh to proceed."
    exit 1
fi

# Add localhost to known hosts
ssh-keyscan localhost >> ~/.ssh/known_hosts

# Kill any existing SSH process running on port 1080
pkill -f "ssh -N -D 0.0.0.0:1080"

# Set up SOCKS5 proxy on port 1080 and make it accessible from anywhere
ssh -N -g -D 0.0.0.0:1080 localhost &

# Check if SSH command is running
if [ $? -eq 0 ]; then
  echo "SOCKS5 proxy set up on port 1080 and accessible from anywhere"
else
  echo "Failed to set up SOCKS5 proxy. Please check SSH settings and network configuration."
fi
